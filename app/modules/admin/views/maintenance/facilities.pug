extends ../../../../templates/admin
block prepend main
	#wrap
	div(style='clear:both')
	.content
		.container-fluid
			.row
				.col-lg-12.col-md-12
						.card
								.card-header.card-header-primary
									.row
										.col-md-6
											h4.card-title Facilities
										.col-md-6
											a.btn.btn-primary.pull-right(href="#" data-toggle="modal" data-target="#conditionModal") Add Facility
								.card-body.table-responsive
										table.table.table-hover.dataTable
												thead.text-primary
														th ID
														th Name
														th Fee
														th Additional Rate
														th Maximum Pax
														th Status
														th.text-center(style=" width:120px") Actions
												tbody
														each facility in facilities
															tr
																td=facility.int_facilityID
																td=facility.var_facilityname
																td="₱"+facility.double_fee +" / "+ facility.time_feeper +" hr(s)"
																td="₱"+facility.double_addrate+" / "+ facility.time_addper+" hr(s)"
																td=facility.int_maxpax
																if(facility.char_facilitystatus=='Cannot be reserved')
																	td
																		select#selectBox(onchange='can(value);' style='color:red' )
																			option(value=`${facility.int_utilitiesfacilityID}`) Cannot be reserved
																			option(value=`${facility.int_utilitiesfacilityID}`  style='color:green') Can be reserved
																if(facility.char_facilitystatus=='Can be reserved')
																	td
																		select#selectBox(onchange='cannot(value);' style='color:green' )
																			option(value=`${facility.int_utilitiesfacilityID}`) Can be reserved
																			option(value=`${facility.int_utilitiesfacilityID}` style='color:red' ) Cannot be reserved
																
																td.td-actions.text-center
																	button.btn.btn-primary.actionButton(type='button' value=`${facility.int_facilityID}`)
																		i.ti-settings
																			#toolbar-options.hidden
																				a.updateButton(href='#')
																					i.ti-pencil(style="color:white;")
																				a.deleteButton(href='#')
																					i.ti-close(style="color:white;")

block addjs
	script.
		function can($i) {
			//- alert($i);
			swal({
					title: 'Are you sure change status?',
					text: "",
					type: 'warning',
					showCancelButton: true,
					confirmButtonColor: '#3085d6',
					cancelButtonColor: '#d33',
					confirmButtonText: 'Confirm'
					}).then((result) => {
						if (result.value) {
							$.post('/admin/maintenance-facilities/changestatus',{id1:$i, facilitystatus:'Can be reserved'})
							.done(data =>{
								if(data){
									swal({
									title:'Success',
									text:'Status changed',
									icon:'success'
									}).then(function(){
										location.reload();
									})
								}
							});
						}
					})
		}
		function cannot($i) {
			//- alert($i);
			swal({
					title: 'Are you sure change status?',
					text: "",
					type: 'warning',
					showCancelButton: true,
					confirmButtonColor: '#3085d6',
					cancelButtonColor: '#d33',
					confirmButtonText: 'Confirm'
					}).then((result) => {
						if (result.value) {
							$.post('/admin/maintenance-facilities/changestatus',{id1:$i, facilitystatus:'Cannot be reserved'})
							.done(data =>{
								if(data){
									swal({
									title:'Success',
									text:'Status changed',
									icon:'success'
									}).then(function(){
										location.reload();
									})
								}
							});
						}
					})
		}
		$(document).ready(function() {
			var idNow;
			$('.actionButton').click(function(){
				idNow = $(this).val();
				console.log(idNow)
			});
			$('.deleteButton').click(function(){
				swal({
					title: 'Are you sure?',
					text: "You won't be able to revert this!",
					type: 'warning',
					showCancelButton: true,
					confirmButtonColor: '#3085d6',
					cancelButtonColor: '#d33',
					confirmButtonText: 'Confirm'
					}).then((result) => {
						if (result.value) {
							$.post('/admin/maintenance-facilities/delete',{id1:idNow})
							.done(data =>{
								if(data){
									swal({
									title:'Success',
									text:'Special event deleted',
									icon:'success'
									}).then(function(){
										location.reload();
									})
								}
							});
						}
					})
				})
			$('.updateButton').click(function(){
					window.location=`/admin/maintenance-facilities/update?id=${idNow}`
				
			})
		});